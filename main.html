<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <title>MySpend - Dashboard</title>
    <script src="https://unpkg.com/@supabase/supabase-js"></script>
    <link rel="stylesheet" href="/style/style.css" />
  </head>
  <body onload="checkSession()">
    <div style="margin: 20px 10px">
      <div class="welcome">
        <h1>Selamat datang, <span id="username"></span></h1>
        <button class="logout" onclick="logout()">Logout</button>
      </div>

      <div id="tabelPengeluaran"></div>

      <!-- rentang pengeluaran -->
      <div id="rentangPengeluaran" class="rentangPengeluaran">
        <h3>Pilih Tanggal Pengeluaran</h3>
        <div class="form-rentangPengeluaran">
          <input type="date" id="tanggalMulai" />
          <p>-</p>
          <input type="date" id="tanggalAkhir" />
          <div id="keperluanContainer" class="keperluanContainer">
            <select id="rentangKeperluan" class="rentangKeperluan">
              <option value="">Semua</option>
              <option value="makan">Makan</option>
              <option value="bensin">Bensin</option>
              <option value="belanja">Belanja</option>
              <option value="laundry">Laundry</option>
              <option value="toko online">Toko Online</option>
              <option value="lain-lain">Lain-lain</option>
            </select>
          </div>
          <button id="tambahKeperluan" class="tambahKeperluan">+</button>
          <select id="rentangMetode">
            <option value="">Semua</option>
            <option value="qris">QRIS</option>
            <option value="cash">Cash</option>
            <option value="transfer">Transfer</option>
          </select>
          <button id="filterButton">Pilih</button>
        </div>
        <div id="hasilTotal" class="total-rentang"></div>
      </div>
      <!-- Pengeluaran -->
      <div class="pengeluaran">
        <h3>Tambah Pengeluaran</h3>
        <div class="form-pengeluaran">
          <input type="date" id="tanggal" />
          <select id="keperluan">
            <option value="makan">Makan</option>
            <option value="bensin">Bensin</option>
            <option value="belanja">Belanja</option>
            <option value="laundry">Laundry</option>
            <option value="toko online">Toko Online</option>
            <option value="lain-lain">Lain-lain</option>
          </select>
          <input type="number" id="jumlah" placeholder="Jumlah" />
          <select id="metode">
            <option value="qris">QRIS</option>
            <option value="cash">Cash</option>
            <option value="transfer">Transfer</option>
          </select>
          <input type="text" id="keterangan" placeholder="Keterangan" />
          <button onclick="tambahPengeluaran()">Simpan</button>
        </div>
        <div class="voice">
          <button id="voiceButton" class="mic-button">
            <svg
              class="mic-icon"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="currentColor"
            >
              <path
                d="M12 14a3 3 0 0 0 3-3V5a3 3 0 0 0-6 0v6a3 3 0 0 0 3 3zm5-3a5 5 0 0 1-10 0H5a7 7 0 0 0 14 0h-2zM11 19h2v3h-2z"
              />
            </svg>
          </button>
          <p id="speechResult" class="speech-result"></p>
        </div>
      </div>

      <!-- Tempat preview hasil pengenalan suara -->
      <div id="voicePreview" class="voice-preview" style="display: none">
        <h3>ðŸ“‹ Preview Pengeluaran dari Suara</h3>
        <div class="preview-item">
          <p><strong>Tanggal:</strong> <span id="prevTanggal"></span></p>
          <p><strong>Keperluan:</strong> <span id="prevKeperluan"></span></p>
          <p><strong>Jumlah:</strong> <span id="prevJumlah"></span></p>
          <p><strong>Metode:</strong> <span id="prevMetode"></span></p>
          <p><strong>keterangan:</strong> <span id="prevKet"></span></p>
        </div>
        <button id="saveVoicePengeluaran">ðŸ’¾ Simpan Pengeluaran</button>
      </div>

      <!-- Catatan Keuangan -->
      <div class="catatan-section">
        <h3>Catatan Keuangan</h3>
        <textarea
          id="catatanTeks"
          placeholder="Tulis catatan keuangan kamu di sini..."
          rows="6"
        ></textarea>
      </div>

      <div class="saldo">
        <h3>Saldo Saat Ini</h3>
        <p>Tabungan: Rp <span id="tabungan">0</span></p>
        <p>Cash: Rp <span id="cash">0</span></p>
        <button onclick="openEditSaldo()">Edit Saldo</button>
      </div>
    </div>
    <!-- Modal Edit Pengeluaran -->
    <div id="editPengeluaranModal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeEditPengeluaran()">&times;</span>
        <h3>Edit Pengeluaran</h3>
        <input type="hidden" id="editId" />
        <label>Tanggal</label>
        <input type="date" id="editTanggal" />
        <label>Keperluan</label>
        <select id="editKeperluan">
          <option value="makan">Makan</option>
          <option value="bensin">Bensin</option>
          <option value="belanja">Belanja</option>
          <option value="laundry">Laundry</option>
          <option value="toko online">Toko Online</option>
          <option value="lain-lain">Lain-lain</option>
        </select>
        <label>Jumlah</label>
        <input type="number" id="editJumlah" />
        <label>Metode</label>
        <input type="hidden" id="editOldMetode" />
        <select id="editMetode">
          <option value="qris">QRIS</option>
          <option value="cash">Cash</option>
          <option value="transfer">Transfer</option>
        </select>
        <label>Keterangan</label>
        <input type="text" id="editKeterangan" />
        <button id="updateButton" onclick="updatePengeluaran()">Simpan</button>
        <button id="hapusButton" onclick="hapusPengeluaran()">Hapus</button>
      </div>
    </div>

    <!-- Modal Edit Saldo -->
    <div id="editSaldoModal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeEditSaldo()">&times;</span>
        <h3>Edit Saldo</h3>

        <!-- Tabungan -->
        <label>Tabungan</label>
        <div class="edit-saldo">
          <input
            type="number"
            id="editTabungan"
            placeholder="Masukkan saldo tabungan"
          />
          <button class="tambah-button" onclick="toggleTambah('tabungan')">
            +
          </button>
        </div>

        <!-- Tambah Tabungan -->
        <div id="tambahTabungan" class="tambah-input" style="display: none">
          <input
            type="number"
            id="jumlahTambahTabungan"
            placeholder="Tambahkan Nominal..."
          />
          <div class="tombol-tambah">
            <button onclick="tambahSaldo('tabungan', 100000)">100.000</button>
            <button onclick="tambahSaldo('tabungan', 50000)">50.000</button>
            <button onclick="tambahSaldo('tabungan', 20000)">20.000</button>
            <button onclick="tambahSaldo('tabungan', 10000)">10.000</button>
            <button onclick="tambahSaldo('tabungan', 5000)">5.000</button>
          </div>
        </div>

        <!-- Cash -->
        <label>Cash</label>
        <div class="edit-saldo">
          <input
            type="number"
            id="editCash"
            placeholder="Masukkan saldo cash"
          />
          <button class="tambah-button" onclick="toggleTambah('cash')">
            +
          </button>
        </div>

        <!-- Tambah Cash -->
        <div id="tambahCash" class="tambah-input" style="display: none">
          <input
            type="number"
            id="jumlahTambahCash"
            placeholder="Tambahkan Nominal..."
          />
          <div class="tombol-tambah">
            <button onclick="tambahSaldo('cash', 100000)">100.000</button>
            <button onclick="tambahSaldo('cash', 50000)">50.000</button>
            <button onclick="tambahSaldo('cash', 20000)">20.000</button>
            <button onclick="tambahSaldo('cash', 10000)">10.000</button>
            <button onclick="tambahSaldo('cash', 5000)">5.000</button>
          </div>
        </div>

        <button class="simpan-button" onclick="updateSaldo()">Simpan</button>
      </div>
    </div>

    <script src="/script/supabase.js"></script>
    <script src="/script/dashboard.js"></script>
    <script src="/script/auth.js"></script>
    <script src="/script/main.js"></script>
  </body>
</html>
